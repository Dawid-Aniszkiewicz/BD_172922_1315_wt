 select kreatura.rodzaj,avg(ekwipunek.ilosc*zasob.waga*zasob.waga)as "srednia waga towarow" from kreatura join ekwipunek on kreatura.idKreatury = ekwipunek.idKreatury join zasob on zasob.Idzasobu = ekwipunek.idZasobu where kreatura.rodzaj!="malpa" and kreatura.rodzaj!="waz" and ekwipunek.ilosc<30 group by kreatura.rodzaj;

select
  kreatura.DataUr as data_starego,
  kreatura.nazwa as stary,
  kreatura.rodzaj,
  k1.DataUr as data_mlodego,
  k1.nazwa as mlody,
  k1.rodzaj
from
  (
    select
      rodzaj,
      min(DataUr) as stary,
      max(DataUr) as mlody
    from
      kreatura
    group by
      rodzaj
  ) daty
  join kreatura on kreatura.DataUr = daty.stary
  and daty.rodzaj = kreatura.rodzaj
  join kreatura k1 on k1.dataUr = daty.mlody
  and daty.rodzaj = k1.rodzaj;
